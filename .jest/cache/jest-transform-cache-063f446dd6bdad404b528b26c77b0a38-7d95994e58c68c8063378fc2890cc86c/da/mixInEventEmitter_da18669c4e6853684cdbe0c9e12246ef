6c165051ba6d4ead37ddf91512ae1450
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var EventEmitter = require('EventEmitter');

var EventEmitterWithHolding = require('EventEmitterWithHolding');

var EventHolder = require('EventHolder');

var invariant = require('fbjs/lib/invariant');

var keyOf = require('fbjs/lib/keyOf');

var TYPES_KEY = keyOf({
  __types: true
});

function mixInEventEmitter(cls, types) {
  invariant(types, 'Must supply set of valid event types');
  var target = cls.prototype || cls;
  invariant(!target.__eventEmitter, 'An active emitter is already mixed in');
  var ctor = cls.constructor;

  if (ctor) {
    invariant(ctor === Object || ctor === Function, 'Mix EventEmitter into a class, not an instance');
  }

  if (target.hasOwnProperty(TYPES_KEY)) {
    (0, _extends2.default)(target.__types, types);
  } else if (target.__types) {
    target.__types = (0, _extends2.default)({}, target.__types, types);
  } else {
    target.__types = types;
  }

  (0, _extends2.default)(target, EventEmitterMixin);
}

var EventEmitterMixin = {
  emit: function emit(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emit(eventType, a, b, c, d, e, _);
  },
  emitAndHold: function emitAndHold(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emitAndHold(eventType, a, b, c, d, e, _);
  },
  addListener: function addListener(eventType, listener, context) {
    return this.__getEventEmitter().addListener(eventType, listener, context);
  },
  once: function once(eventType, listener, context) {
    return this.__getEventEmitter().once(eventType, listener, context);
  },
  addRetroactiveListener: function addRetroactiveListener(eventType, listener, context) {
    return this.__getEventEmitter().addRetroactiveListener(eventType, listener, context);
  },
  addListenerMap: function addListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },
  addRetroactiveListenerMap: function addRetroactiveListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },
  removeAllListeners: function removeAllListeners() {
    this.__getEventEmitter().removeAllListeners();
  },
  removeCurrentListener: function removeCurrentListener() {
    this.__getEventEmitter().removeCurrentListener();
  },
  releaseHeldEventType: function releaseHeldEventType(eventType) {
    this.__getEventEmitter().releaseHeldEventType(eventType);
  },
  __getEventEmitter: function __getEventEmitter() {
    if (!this.__eventEmitter) {
      var emitter = new EventEmitter();

      if (__DEV__) {
        var EventValidator = require('EventValidator');

        emitter = EventValidator.addValidation(emitter, this.__types);
      }

      var holder = new EventHolder();
      this.__eventEmitter = new EventEmitterWithHolding(emitter, holder);
    }

    return this.__eventEmitter;
  }
};
module.exports = mixInEventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1peEluRXZlbnRFbWl0dGVyLmpzIl0sIm5hbWVzIjpbIkV2ZW50RW1pdHRlciIsInJlcXVpcmUiLCJFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyIsIkV2ZW50SG9sZGVyIiwiaW52YXJpYW50Iiwia2V5T2YiLCJUWVBFU19LRVkiLCJfX3R5cGVzIiwibWl4SW5FdmVudEVtaXR0ZXIiLCJjbHMiLCJ0eXBlcyIsInRhcmdldCIsInByb3RvdHlwZSIsIl9fZXZlbnRFbWl0dGVyIiwiY3RvciIsImNvbnN0cnVjdG9yIiwiT2JqZWN0IiwiRnVuY3Rpb24iLCJoYXNPd25Qcm9wZXJ0eSIsIkV2ZW50RW1pdHRlck1peGluIiwiZW1pdCIsImV2ZW50VHlwZSIsImEiLCJiIiwiYyIsImQiLCJlIiwiXyIsIl9fZ2V0RXZlbnRFbWl0dGVyIiwiZW1pdEFuZEhvbGQiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyIiwiY29udGV4dCIsIm9uY2UiLCJhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyIiwiYWRkTGlzdGVuZXJNYXAiLCJsaXN0ZW5lck1hcCIsImFkZFJldHJvYWN0aXZlTGlzdGVuZXJNYXAiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVDdXJyZW50TGlzdGVuZXIiLCJyZWxlYXNlSGVsZEV2ZW50VHlwZSIsImVtaXR0ZXIiLCJfX0RFVl9fIiwiRXZlbnRWYWxpZGF0b3IiLCJhZGRWYWxpZGF0aW9uIiwiaG9sZGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUE7Ozs7OztBQUVBLElBQU1BLFlBQVksR0FBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBNUI7O0FBQ0EsSUFBTUMsdUJBQXVCLEdBQUdELE9BQU8sQ0FBQyx5QkFBRCxDQUF2Qzs7QUFDQSxJQUFNRSxXQUFXLEdBQUdGLE9BQU8sQ0FBQyxhQUFELENBQTNCOztBQUVBLElBQU1HLFNBQVMsR0FBR0gsT0FBTyxDQUFDLG9CQUFELENBQXpCOztBQUlBLElBQU1JLEtBQUssR0FBR0osT0FBTyxDQUFD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Q0Q7QUF6RHVCLENBQTFCO0FBNERBaUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCdkMsaUJBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvd1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnRXZlbnRFbWl0dGVyJyk7XG5jb25zdCBFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyA9IHJlcXVpcmUoJ0V2ZW50RW1pdHRlcldpdGhIb2xkaW5nJyk7XG5jb25zdCBFdmVudEhvbGRlciA9IHJlcXVpcmUoJ0V2ZW50SG9sZGVyJyk7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuLyogJEZsb3dGaXhNZSg+PTAuNTQuMCBzaXRlPXJlYWN0X25hdGl2ZV9vc3MpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yXG4gKiBmb3VuZCB3aGVuIEZsb3cgdjAuNTQgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kXG4gKiBydW4gRmxvdy4gKi9cbmNvbnN0IGtleU9mID0gcmVxdWlyZSgnZmJqcy9saWIva2V5T2YnKTtcblxuaW1wb3J0IHR5cGUgRW1pdHRlclN1YnNjcmlwdGlvbiBmcm9tICdFbWl0dGVyU3Vic2NyaXB0aW9uJztcblxuY29uc3QgVFlQRVNfS0VZID0ga2V5T2Yoe19fdHlwZXM6IHRydWV9KTtcblxuLyoqXG4gKiBBUEkgdG8gc2V0dXAgYW4gb2JqZWN0IG9yIGNvbnN0cnVjdG9yIHRvIGJlIGFibGUgdG8gZW1pdCBkYXRhIGV2ZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogZnVuY3Rpb24gRG9nKCkgeyAuLi5kb2cgc3R1ZmYuLi4gfVxuICogbWl4SW5FdmVudEVtaXR0ZXIoRG9nLCB7YmFyazogdHJ1ZX0pO1xuICpcbiAqIHZhciBwdXBweSA9IG5ldyBEb2coKTtcbiAqIHB1cHB5LmFkZExpc3RlbmVyKCdiYXJrJywgZnVuY3Rpb24gKHZvbHVtZSkge1xuICogICBjb25zb2xlLmxvZygnUHVwcHknLCB0aGlzLCAnYmFya2VkIGF0IHZvbHVtZTonLCB2b2x1bWUpO1xuICogfSk7XG4gKiBwdXBweS5lbWl0KCdiYXJrJywgJ3F1aWV0Jyk7XG4gKiAvLyBQdXBweSA8cHVwcHk+IGJhcmtlZCBhdCB2b2x1bWU6IHF1aWV0XG4gKlxuICpcbiAqIC8vIEEgXCJzaW5nbGV0b25cIiBvYmplY3QgbWF5IGFsc28gYmUgY29tbWlzc2lvbmVkOlxuICpcbiAqIHZhciBTaW5nbGV0b24gPSB7fTtcbiAqIG1peEluRXZlbnRFbWl0dGVyKFNpbmdsZXRvbiwge2xvbmVseTogdHJ1ZX0pO1xuICogU2luZ2xldG9uLmVtaXQoJ2xvbmVseScsIHRydWUpO1xuICovXG5mdW5jdGlvbiBtaXhJbkV2ZW50RW1pdHRlcihjbHM6IEZ1bmN0aW9uIHwgT2JqZWN0LCB0eXBlczogT2JqZWN0KSB7XG4gIGludmFyaWFudCh0eXBlcywgJ011c3Qgc3VwcGx5IHNldCBvZiB2YWxpZCBldmVudCB0eXBlcycpO1xuXG4gIC8vIElmIHRoaXMgaXMgYSBjb25zdHJ1Y3Rvciwgd3JpdGUgdG8gdGhlIHByb3RvdHlwZSwgb3RoZXJ3aXNlIHdyaXRlIHRvIHRoZVxuICAvLyBzaW5nbGV0b24gb2JqZWN0LlxuICBjb25zdCB0YXJnZXQgPSBjbHMucHJvdG90eXBlIHx8IGNscztcblxuICBpbnZhcmlhbnQoIXRhcmdldC5fX2V2ZW50RW1pdHRlciwgJ0FuIGFjdGl2ZSBlbWl0dGVyIGlzIGFscmVhZHkgbWl4ZWQgaW4nKTtcblxuICBjb25zdCBjdG9yID0gY2xzLmNvbnN0cnVjdG9yO1xuICBpZiAoY3Rvcikge1xuICAgIGludmFyaWFudChcbiAgICAgIGN0b3IgPT09IE9iamVjdCB8fCBjdG9yID09PSBGdW5jdGlvbixcbiAgICAgICdNaXggRXZlbnRFbWl0dGVyIGludG8gYSBjbGFzcywgbm90IGFuIGluc3RhbmNlJyxcbiAgICApO1xuICB9XG5cbiAgLy8gS2VlcCB0cmFjayBvZiB0aGUgcHJvdmlkZWQgdHlwZXMsIHVuaW9uIHRoZSB0eXBlcyBpZiB0aGV5IGFscmVhZHkgZXhpc3QsXG4gIC8vIHdoaWNoIGFsbG93cyBmb3IgcHJvdG90eXBlIHN1YmNsYXNzZXMgdG8gcHJvdmlkZSBtb3JlIHR5cGVzLlxuICBpZiAodGFyZ2V0Lmhhc093blByb3BlcnR5KFRZUEVTX0tFWSkpIHtcbiAgICBPYmplY3QuYXNzaWduKHRhcmdldC5fX3R5cGVzLCB0eXBlcyk7XG4gIH0gZWxzZSBpZiAodGFyZ2V0Ll9fdHlwZXMpIHtcbiAgICB0YXJnZXQuX190eXBlcyA9IE9iamVjdC5hc3NpZ24oe30sIHRhcmdldC5fX3R5cGVzLCB0eXBlcyk7XG4gIH0gZWxzZSB7XG4gICAgdGFyZ2V0Ll9fdHlwZXMgPSB0eXBlcztcbiAgfVxuICBPYmplY3QuYXNzaWduKHRhcmdldCwgRXZlbnRFbWl0dGVyTWl4aW4pO1xufVxuXG5jb25zdCBFdmVudEVtaXR0ZXJNaXhpbiA9IHtcbiAgZW1pdDogZnVuY3Rpb24oZXZlbnRUeXBlLCBhLCBiLCBjLCBkLCBlLCBfKSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5lbWl0KGV2ZW50VHlwZSwgYSwgYiwgYywgZCwgZSwgXyk7XG4gIH0sXG5cbiAgZW1pdEFuZEhvbGQ6IGZ1bmN0aW9uKGV2ZW50VHlwZSwgYSwgYiwgYywgZCwgZSwgXykge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuZW1pdEFuZEhvbGQoZXZlbnRUeXBlLCBhLCBiLCBjLCBkLCBlLCBfKTtcbiAgfSxcblxuICBhZGRMaXN0ZW5lcjogZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCk6IEVtaXR0ZXJTdWJzY3JpcHRpb24ge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuYWRkTGlzdGVuZXIoZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCk7XG4gIH0sXG5cbiAgb25jZTogZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkub25jZShldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KTtcbiAgfSxcblxuICBhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyOiBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5hZGRSZXRyb2FjdGl2ZUxpc3RlbmVyKFxuICAgICAgZXZlbnRUeXBlLFxuICAgICAgbGlzdGVuZXIsXG4gICAgICBjb250ZXh0LFxuICAgICk7XG4gIH0sXG5cbiAgYWRkTGlzdGVuZXJNYXA6IGZ1bmN0aW9uKGxpc3RlbmVyTWFwLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5hZGRMaXN0ZW5lck1hcChsaXN0ZW5lck1hcCwgY29udGV4dCk7XG4gIH0sXG5cbiAgYWRkUmV0cm9hY3RpdmVMaXN0ZW5lck1hcDogZnVuY3Rpb24obGlzdGVuZXJNYXAsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmFkZExpc3RlbmVyTWFwKGxpc3RlbmVyTWFwLCBjb250ZXh0KTtcbiAgfSxcblxuICByZW1vdmVBbGxMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgfSxcblxuICByZW1vdmVDdXJyZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5yZW1vdmVDdXJyZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICByZWxlYXNlSGVsZEV2ZW50VHlwZTogZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLnJlbGVhc2VIZWxkRXZlbnRUeXBlKGV2ZW50VHlwZSk7XG4gIH0sXG5cbiAgX19nZXRFdmVudEVtaXR0ZXI6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5fX2V2ZW50RW1pdHRlcikge1xuICAgICAgbGV0IGVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICBpZiAoX19ERVZfXykge1xuICAgICAgICBjb25zdCBFdmVudFZhbGlkYXRvciA9IHJlcXVpcmUoJ0V2ZW50VmFsaWRhdG9yJyk7XG4gICAgICAgIGVtaXR0ZXIgPSBFdmVudFZhbGlkYXRvci5hZGRWYWxpZGF0aW9uKGVtaXR0ZXIsIHRoaXMuX190eXBlcyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGhvbGRlciA9IG5ldyBFdmVudEhvbGRlcigpO1xuICAgICAgdGhpcy5fX2V2ZW50RW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyhlbWl0dGVyLCBob2xkZXIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fX2V2ZW50RW1pdHRlcjtcbiAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbWl4SW5FdmVudEVtaXR0ZXI7XG4iXX0=