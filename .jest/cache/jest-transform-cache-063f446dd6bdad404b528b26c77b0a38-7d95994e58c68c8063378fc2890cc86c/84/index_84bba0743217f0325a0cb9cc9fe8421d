d40f776e442b30247607f5c0ee2108a4
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const redux_observable_1 = require("redux-observable");
const ActionTypes_1 = require("../../ActionTypes");
const rxjs_1 = require("rxjs");
const operators_1 = require("rxjs/operators");
exports.errorTitle = 'Error';
exports.errorMessage = 'Insufficient funds';
exports.default = (action, store) => action.pipe(redux_observable_1.ofType(ActionTypes_1.TypeKeys.SEND_MONEY), operators_1.mergeMap((action$) => {
    let state = store.value;
    let total = state.account.totalAvailable;
    let amount = +action$.transaction.amount;
    return ((total - amount) >= 0)
        ? rxjs_1.of({ type: ActionTypes_1.TypeKeys.SEND_MONEY_SUCCESS, transaction: action$.transaction })
        : rxjs_1.concat(rxjs_1.of({ type: ActionTypes_1.TypeKeys.SEND_MONEY_FAIL }), rxjs_1.of({ type: ActionTypes_1.TypeKeys.SHOW_ERROR, title: 'Error', message: 'Insufficient funds' }));
}), operators_1.delay(3000));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2RhdmlkbXVycGh5L0Rlc2t0b3AvTW9uZXlTZW5kZXIvc3JjL1NlbmQvRXBpY3MvaW5kZXgudHN4IiwibWFwcGluZ3MiOiI7O0FBQ0EsdURBQTZFO0FBQzdFLG1EQUE0QztBQUU1QywrQkFBNkM7QUFDN0MsOENBQWdEO0FBSW5DLFFBQUEsVUFBVSxHQUFHLE9BQU8sQ0FBQTtBQUNwQixRQUFBLFlBQVksR0FBRyxvQkFBb0IsQ0FBQTtBQUVoRCxrQkFBZSxDQUFDLE1BQWlDLEVBQUUsS0FBNkIsRUFBRyxFQUFFLENBQ25GLE1BQU0sQ0FBQyxJQUFJLENBQ1QseUJBQU0sQ0FBQyxzQkFBUSxDQUFDLFVBQVUsQ0FBQyxFQUMzQixvQkFBUSxDQUFDLENBQUMsT0FBd0IsRUFBMEUsRUFBRTtJQUMxRyxJQUFJLEtBQUssR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFBO0lBQ3ZCLElBQUksS0FBSyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFBO0lBQ3hDLElBQUksTUFBTSxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUE7SUFDeEMsT0FBTyxDQUFFLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvQixDQUFDLENBQUMsU0FBRSxDQUF5QixFQUFFLElBQUksRUFBRSxzQkFBUSxDQUFDLGtCQUFrQixFQUFFLFdBQVcsRUFBRSxPQUFPLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDckcsQ0FBQyxDQUFDLGFBQU0sQ0FBRSxTQUFFLENBQXNCLEVBQUUsSUFBSSxFQUFFLHNCQUFRLENBQUMsZUFBZSxFQUFFLENBQUMsRUFDbkUsU0FBRSxDQUFjLEVBQUUsSUFBSSxFQUFFLHNCQUFRLENBQUMsVUFBVSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLENBQUMsQ0FBRSxDQUFBO0FBQ25HLENBQUMsQ0FDRixFQUNELGlCQUFLLENBQUMsSUFBSSxDQUFDLENBQ1osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZGF2aWRtdXJwaHkvRGVza3RvcC9Nb25leVNlbmRlci9zcmMvU2VuZC9FcGljcy9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAncmVkdXgnXG5pbXBvcnQgeyBvZlR5cGUsIEFjdGlvbnNPYnNlcnZhYmxlLCBTdGF0ZU9ic2VydmFibGUgfSBmcm9tICdyZWR1eC1vYnNlcnZhYmxlJ1xuaW1wb3J0IHsgVHlwZUtleXMgfSBmcm9tICcuLi8uLi9BY3Rpb25UeXBlcydcbmltcG9ydCB7IFNlbmRNb25leUFjdGlvbiwgU2VuZE1vbmV5QWN0aW9uU3VjY2VzcywgU2VuZE1vbmV5QWN0aW9uRmFpbCB9IGZyb20gJy4uL1JlZHVjZXJzJ1xuaW1wb3J0IHsgb2YsIGNvbmNhdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnXG5pbXBvcnQgeyBtZXJnZU1hcCwgZGVsYXkgfSBmcm9tICdyeGpzL29wZXJhdG9ycydcbmltcG9ydCB7IEVycm9yQWN0aW9uIH0gZnJvbSAnLi4vLi4vRXJyb3InXG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uLy4uL0FwcCdcblxuZXhwb3J0IGNvbnN0IGVycm9yVGl0bGUgPSAnRXJyb3InXG5leHBvcnQgY29uc3QgZXJyb3JNZXNzYWdlID0gJ0luc3VmZmljaWVudCBmdW5kcydcblxuZXhwb3J0IGRlZmF1bHQgKGFjdGlvbjogQWN0aW9uc09ic2VydmFibGU8QWN0aW9uPiwgc3RvcmU6IFN0YXRlT2JzZXJ2YWJsZTxTdGF0ZT4gKSA9PlxuICBhY3Rpb24ucGlwZShcbiAgICBvZlR5cGUoVHlwZUtleXMuU0VORF9NT05FWSksXG4gICAgbWVyZ2VNYXAoKGFjdGlvbiQ6IFNlbmRNb25leUFjdGlvbik6IE9ic2VydmFibGU8U2VuZE1vbmV5QWN0aW9uU3VjY2VzcyB8IEVycm9yQWN0aW9uIHwgU2VuZE1vbmV5QWN0aW9uRmFpbD4gPT4ge1xuICAgICAgICBsZXQgc3RhdGUgPSBzdG9yZS52YWx1ZVxuICAgICAgICBsZXQgdG90YWwgPSBzdGF0ZS5hY2NvdW50LnRvdGFsQXZhaWxhYmxlXG4gICAgICAgIGxldCBhbW91bnQgPSArYWN0aW9uJC50cmFuc2FjdGlvbi5hbW91bnRcbiAgICAgICAgcmV0dXJuICggKHRvdGFsIC0gYW1vdW50KSA+PSAwKVxuICAgICAgICA/IG9mPFNlbmRNb25leUFjdGlvblN1Y2Nlc3M+KHsgdHlwZTogVHlwZUtleXMuU0VORF9NT05FWV9TVUNDRVNTLCB0cmFuc2FjdGlvbjogYWN0aW9uJC50cmFuc2FjdGlvbiB9KVxuICAgICAgICA6IGNvbmNhdCggb2Y8U2VuZE1vbmV5QWN0aW9uRmFpbD4oeyB0eXBlOiBUeXBlS2V5cy5TRU5EX01PTkVZX0ZBSUwgfSksXG4gICAgICAgICAgb2Y8RXJyb3JBY3Rpb24+KHsgdHlwZTogVHlwZUtleXMuU0hPV19FUlJPUiwgdGl0bGU6ICdFcnJvcicsIG1lc3NhZ2U6ICdJbnN1ZmZpY2llbnQgZnVuZHMnIH0pIClcbiAgICAgIH1cbiAgICApLFxuICAgIGRlbGF5KDMwMDApXG4gICk7Il0sInZlcnNpb24iOjN9